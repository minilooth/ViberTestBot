2020-12-16 01:40:20.339  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 01:40:23.232  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 01:40:23.235  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 01:40:23.248  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 01:40:24.449  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 01:40:24.608  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 135ms. Found 9 JPA repository interfaces.
2020-12-16 01:40:25.282  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 01:40:25.383  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 01:40:26.805  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 01:40:26.839  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 01:40:26.841  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 01:40:27.111  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 01:40:27.112  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 3779 ms
2020-12-16 01:40:27.611  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 01:40:27.735  INFO 17712 --- [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.4.22.Final
2020-12-16 01:40:28.127  INFO 17712 --- [restartedMain] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.0.Final}
2020-12-16 01:40:28.334  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2020-12-16 01:40:33.231  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2020-12-16 01:40:33.490  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 01:41:11.985  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 01:41:11.993  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:41:12.057  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 01:41:12.377  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 01:41:13.883  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 01:41:13.885  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:41:13.914  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 01:41:13.919  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 01:41:13.929  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 01:41:13.956  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 01:41:13.963  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 01:41:15.300  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 01:41:15.683  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 57.582 seconds (JVM running for 58.798)
2020-12-16 01:41:16.869  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 01:41:16.871  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 01:41:16.897  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 13 ms
2020-12-16 01:41:17.246  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 01:41:17.265  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 01:43:46.849  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received UnsubscribedCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:43:49.899  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Received ConversationStartedCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:43:54.022  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:43:55.378  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:43:55.378  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : New user registered: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:43:56.758  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:43:56.902  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:43:58.285  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:43:58.425  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:44:01.466  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:44:01.667  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:44:01.815  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:44:05.111  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:44:05.271  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:44:08.892  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:44:09.039  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:44:09.162  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:44:11.671  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:44:11.817  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:44:11.942  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:44:14.489  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:44:14.632  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:44:18.178  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:44:18.298  WARN 17712 --- [http-nio-5000-exec-3] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 1364, SQLState: HY000
2020-12-16 01:44:18.299 ERROR 17712 --- [http-nio-5000-exec-3] o.h.engine.jdbc.spi.SqlExceptionHelper   : Field 'IsLast' doesn't have a default value
2020-12-16 01:44:18.347 ERROR 17712 --- [http-nio-5000-exec-3] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.orm.jpa.JpaSystemException: could not execute statement; nested exception is org.hibernate.exception.GenericJDBCException: could not execute statement] with root cause

java.sql.SQLException: Field 'IsLast' doesn't have a default value
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:129) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1092) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1040) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1347) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1025) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-3.4.5.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-3.4.5.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.dialect.identity.GetGeneratedKeysDelegate.executeAndExtract(GetGeneratedKeysDelegate.java:57) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.id.insert.AbstractReturningDelegate.performInsert(AbstractReturningDelegate.java:43) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:3158) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:3764) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:84) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:645) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:282) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:263) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:317) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:330) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:287) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:193) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:123) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:185) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:128) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:102) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:720) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:706) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:366) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at com.sun.proxy.$Proxy110.persist(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:314) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at com.sun.proxy.$Proxy110.persist(Unknown Source) ~[na:na]
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:554) ~[spring-data-jpa-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.data.repository.core.support.ImplementationInvocationMetadata.invoke(ImplementationInvocationMetadata.java:72) ~[spring-data-commons-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:382) ~[spring-data-commons-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:205) ~[spring-data-commons-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:550) ~[spring-data-commons-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:155) ~[spring-data-commons-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:130) ~[spring-data-commons-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:80) ~[spring-data-commons-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:367) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:178) ~[spring-data-jpa-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:95) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at com.sun.proxy.$Proxy118.save(Unknown Source) ~[na:na]
	at by.testbot.services.ButtonService.save(ButtonService.java:29) ~[classes/:na]
	at by.testbot.services.ButtonService$$FastClassBySpringCGLIB$$a7ad0c03.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:367) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.ButtonService$$EnhancerBySpringCGLIB$$5d6431a4.save(<generated>) ~[classes/:na]
	at by.testbot.bot.BotState$20.handleInput(BotState.java:923) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleTextMessage(ViberService.java:641) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleMessageCallback(ViberService.java:434) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleUpdate(ViberService.java:425) ~[classes/:na]
	at by.testbot.services.viber.WebhookService.onWebhookUpdateReceived(WebhookService.java:69) ~[classes/:na]
	at by.testbot.controllers.WebhookController.onUpdateReceived(WebhookController.java:19) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652) ~[tomcat-embed-core-9.0.39.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733) ~[tomcat-embed-core-9.0.39.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]

2020-12-16 01:44:18.770  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:44:18.845  WARN 17712 --- [http-nio-5000-exec-4] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 1364, SQLState: HY000
2020-12-16 01:44:18.889 ERROR 17712 --- [http-nio-5000-exec-4] o.h.engine.jdbc.spi.SqlExceptionHelper   : Field 'IsLast' doesn't have a default value
2020-12-16 01:44:18.894 ERROR 17712 --- [http-nio-5000-exec-4] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.orm.jpa.JpaSystemException: could not execute statement; nested exception is org.hibernate.exception.GenericJDBCException: could not execute statement] with root cause

java.sql.SQLException: Field 'IsLast' doesn't have a default value
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:129) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:122) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1092) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdateInternal(ClientPreparedStatement.java:1040) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeLargeUpdate(ClientPreparedStatement.java:1347) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeUpdate(ClientPreparedStatement.java:1025) ~[mysql-connector-java-8.0.22.jar:8.0.22]
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61) ~[HikariCP-3.4.5.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java) ~[HikariCP-3.4.5.jar:na]
	at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetReturnImpl.java:197) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.dialect.identity.GetGeneratedKeysDelegate.executeAndExtract(GetGeneratedKeysDelegate.java:57) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.id.insert.AbstractReturningDelegate.performInsert(AbstractReturningDelegate.java:43) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:3158) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:3764) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:84) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:645) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:282) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:263) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:317) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:330) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:287) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:193) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:123) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:185) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:128) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:55) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:102) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:720) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:706) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.orm.jpa.ExtendedEntityManagerCreator$ExtendedEntityManagerInvocationHandler.invoke(ExtendedEntityManagerCreator.java:366) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at com.sun.proxy.$Proxy110.persist(Unknown Source) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:314) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at com.sun.proxy.$Proxy110.persist(Unknown Source) ~[na:na]
	at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:554) ~[spring-data-jpa-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.data.repository.core.support.ImplementationInvocationMetadata.invoke(ImplementationInvocationMetadata.java:72) ~[spring-data-commons-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.data.repository.core.support.RepositoryComposition$RepositoryFragments.invoke(RepositoryComposition.java:382) ~[spring-data-commons-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.data.repository.core.support.RepositoryComposition.invoke(RepositoryComposition.java:205) ~[spring-data-commons-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.data.repository.core.support.RepositoryFactorySupport$ImplementationMethodExecutionInterceptor.invoke(RepositoryFactorySupport.java:550) ~[spring-data-commons-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:155) ~[spring-data-commons-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:130) ~[spring-data-commons-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:80) ~[spring-data-commons-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:367) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:139) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.data.jpa.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:178) ~[spring-data-jpa-2.3.5.RELEASE.jar:2.3.5.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:95) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at com.sun.proxy.$Proxy118.save(Unknown Source) ~[na:na]
	at by.testbot.services.ButtonService.save(ButtonService.java:29) ~[classes/:na]
	at by.testbot.services.ButtonService$$FastClassBySpringCGLIB$$a7ad0c03.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:367) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.ButtonService$$EnhancerBySpringCGLIB$$5d6431a4.save(<generated>) ~[classes/:na]
	at by.testbot.bot.BotState$20.handleInput(BotState.java:923) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleTextMessage(ViberService.java:641) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleMessageCallback(ViberService.java:434) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleUpdate(ViberService.java:425) ~[classes/:na]
	at by.testbot.services.viber.WebhookService.onWebhookUpdateReceived(WebhookService.java:69) ~[classes/:na]
	at by.testbot.controllers.WebhookController.onUpdateReceived(WebhookController.java:19) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652) ~[tomcat-embed-core-9.0.39.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733) ~[tomcat-embed-core-9.0.39.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]

2020-12-16 01:45:06.223  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:45:06.563  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:45:08.612  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:45:08.882  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:45:10.751  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:45:11.047  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:45:19.224  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:45:19.394  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:45:49.915  INFO 17712 --- [Thread-6] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:45:49.916  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 01:45:52.916  WARN 17712 --- [Thread-6] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 01:45:52.921  INFO 17712 --- [Thread-6] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:45:53.033  INFO 17712 --- [Thread-6] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
2020-12-16 01:45:53.330  INFO 17712 --- [Thread-6] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
2020-12-16 01:45:55.226  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 01:45:57.246  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 01:45:57.247  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 01:45:57.249  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 01:45:57.779  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 01:45:57.858  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 77ms. Found 9 JPA repository interfaces.
2020-12-16 01:45:57.987  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 01:45:58.001  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 01:45:58.860  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 01:45:58.860  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 01:45:58.862  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 01:45:58.925  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 01:45:58.926  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1661 ms
2020-12-16 01:45:59.037  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 01:45:59.053  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-2 - Starting...
2020-12-16 01:45:59.858  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-2 - Start completed.
2020-12-16 01:45:59.859  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 01:46:02.043  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 01:46:02.044  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:46:02.056  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 01:46:02.129  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 01:46:02.437  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 01:46:02.438  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:46:02.446  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 01:46:02.456  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 01:46:02.456  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 01:46:02.934  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 01:46:03.252  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 8.845 seconds (JVM running for 346.367)
2020-12-16 01:46:03.257  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 01:46:04.088  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 01:46:04.090  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 01:46:04.094  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
2020-12-16 01:46:04.242  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 01:46:04.248  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 01:46:38.965  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:46:39.113 ERROR 17712 --- [http-nio-5000-exec-2] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.NullPointerException] with root cause

java.lang.NullPointerException: null
	at by.testbot.bot.BotState$16.handleInput(BotState.java:773) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleTextMessage(ViberService.java:641) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleMessageCallback(ViberService.java:434) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleUpdate(ViberService.java:425) ~[classes/:na]
	at by.testbot.services.viber.WebhookService.onWebhookUpdateReceived(WebhookService.java:69) ~[classes/:na]
	at by.testbot.controllers.WebhookController.onUpdateReceived(WebhookController.java:19) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652) ~[tomcat-embed-core-9.0.39.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733) ~[tomcat-embed-core-9.0.39.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]

2020-12-16 01:46:39.360  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:46:39.372 ERROR 17712 --- [http-nio-5000-exec-3] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.NullPointerException] with root cause

java.lang.NullPointerException: null
	at by.testbot.bot.BotState$16.handleInput(BotState.java:773) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleTextMessage(ViberService.java:641) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleMessageCallback(ViberService.java:434) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleUpdate(ViberService.java:425) ~[classes/:na]
	at by.testbot.services.viber.WebhookService.onWebhookUpdateReceived(WebhookService.java:69) ~[classes/:na]
	at by.testbot.controllers.WebhookController.onUpdateReceived(WebhookController.java:19) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652) ~[tomcat-embed-core-9.0.39.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733) ~[tomcat-embed-core-9.0.39.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]

2020-12-16 01:46:49.922 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 01:47:39.648  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:47:39.669 ERROR 17712 --- [http-nio-5000-exec-4] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is java.lang.NullPointerException] with root cause

java.lang.NullPointerException: null
	at by.testbot.bot.BotState$16.handleInput(BotState.java:773) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleTextMessage(ViberService.java:641) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleMessageCallback(ViberService.java:434) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleUpdate(ViberService.java:425) ~[classes/:na]
	at by.testbot.services.viber.WebhookService.onWebhookUpdateReceived(WebhookService.java:69) ~[classes/:na]
	at by.testbot.controllers.WebhookController.onUpdateReceived(WebhookController.java:19) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652) ~[tomcat-embed-core-9.0.39.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733) ~[tomcat-embed-core-9.0.39.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]

2020-12-16 01:48:14.416  INFO 17712 --- [Thread-11] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:48:14.417  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 01:48:17.418  WARN 17712 --- [Thread-11] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 01:48:17.421  INFO 17712 --- [Thread-11] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:48:17.422  INFO 17712 --- [Thread-11] com.zaxxer.hikari.HikariDataSource       : HikariPool-2 - Shutdown initiated...
2020-12-16 01:48:17.437  INFO 17712 --- [Thread-11] com.zaxxer.hikari.HikariDataSource       : HikariPool-2 - Shutdown completed.
2020-12-16 01:48:20.453  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 01:48:22.584  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 01:48:22.585  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 01:48:22.587  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 01:48:23.084  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 01:48:23.272  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 187ms. Found 9 JPA repository interfaces.
2020-12-16 01:48:23.616  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 01:48:23.660  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 01:48:24.027  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 01:48:24.031  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 01:48:24.032  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 01:48:24.102  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 01:48:24.103  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1510 ms
2020-12-16 01:48:24.240  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 01:48:24.680  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-3 - Starting...
2020-12-16 01:48:24.715  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-3 - Start completed.
2020-12-16 01:48:24.721  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 01:48:25.489  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 01:48:25.492  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:48:25.507  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 01:48:25.636  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 01:48:26.447  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 01:48:26.451  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:48:26.467  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 01:48:26.479  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 01:48:26.489  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 01:48:27.347  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 01:48:27.814  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 10.259 seconds (JVM running for 490.929)
2020-12-16 01:48:27.818  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 01:48:28.549  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 01:48:28.551  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 01:48:28.556  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 5 ms
2020-12-16 01:48:28.697  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 01:48:28.703  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 01:49:14.423 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 01:50:35.802  INFO 17712 --- [Thread-19] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:50:35.820  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 01:50:38.836  WARN 17712 --- [Thread-19] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 01:50:38.847  INFO 17712 --- [Thread-19] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:50:38.848  INFO 17712 --- [Thread-19] com.zaxxer.hikari.HikariDataSource       : HikariPool-3 - Shutdown initiated...
2020-12-16 01:50:38.888  INFO 17712 --- [Thread-19] com.zaxxer.hikari.HikariDataSource       : HikariPool-3 - Shutdown completed.
2020-12-16 01:50:41.618  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 01:50:44.100  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 01:50:44.103  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 01:50:44.105  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 01:50:45.613  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 01:50:46.020  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 394ms. Found 9 JPA repository interfaces.
2020-12-16 01:50:46.322  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 01:50:46.355  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 01:50:46.780  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 01:50:46.810  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 01:50:46.813  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 01:50:46.888  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 01:50:46.889  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 2776 ms
2020-12-16 01:50:47.046  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 01:50:47.115  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-4 - Starting...
2020-12-16 01:50:47.156  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-4 - Start completed.
2020-12-16 01:50:47.157  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 01:50:48.555  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 01:50:48.561  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:50:48.575  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 01:50:48.679  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 01:50:49.454  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 01:50:49.464  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:50:49.485  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 01:50:49.492  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 01:50:49.493  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 01:50:50.591  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 01:50:51.659  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 12.561 seconds (JVM running for 634.774)
2020-12-16 01:50:51.670  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 01:50:52.511  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 01:50:52.523  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 01:50:52.532  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 5 ms
2020-12-16 01:50:52.701  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 01:50:52.733  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 01:51:26.825  INFO 17712 --- [Thread-27] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:51:26.826  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 01:51:29.827  WARN 17712 --- [Thread-27] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 01:51:29.829  INFO 17712 --- [Thread-27] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:51:29.830  INFO 17712 --- [Thread-27] com.zaxxer.hikari.HikariDataSource       : HikariPool-4 - Shutdown initiated...
2020-12-16 01:51:29.845  INFO 17712 --- [Thread-27] com.zaxxer.hikari.HikariDataSource       : HikariPool-4 - Shutdown completed.
2020-12-16 01:51:30.927  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 01:51:32.956  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 01:51:32.957  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 01:51:32.972  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 01:51:33.229  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 01:51:33.328  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 98ms. Found 9 JPA repository interfaces.
2020-12-16 01:51:33.509  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 01:51:33.528  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 01:51:33.710  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 01:51:33.712  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 01:51:33.726  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 01:51:33.793  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 01:51:33.794  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 817 ms
2020-12-16 01:51:33.888  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 01:51:33.900  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-5 - Starting...
2020-12-16 01:51:33.952  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-5 - Start completed.
2020-12-16 01:51:33.953  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 01:51:34.556  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 01:51:34.556  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:51:34.565  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 01:51:34.630  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 01:51:34.924  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 01:51:34.925  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:51:34.934  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 01:51:34.940  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 01:51:34.941  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 01:51:35.361  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 01:51:35.648  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 5.638 seconds (JVM running for 678.764)
2020-12-16 01:51:35.651  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 01:51:35.827 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 01:51:36.405  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 01:51:36.406  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 01:51:36.410  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
2020-12-16 01:51:36.560  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 01:51:36.565  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 01:51:40.741  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:51:41.030  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:51:41.170  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:51:53.566  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:51:53.712  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:51:53.844  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:51:57.035  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:51:57.174  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:51:59.454  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:51:59.616  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:02.122  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:02.444  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:04.071  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:04.402  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:05.911  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:06.185  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:08.196  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:08.520  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:08.642  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:11.428  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:11.562  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:11.689  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:14.572  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:14.711  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:18.081  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:18.380  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:22.239  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:22.477  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:24.923  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:25.170  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:26.833 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 01:52:27.039  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:27.272  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:27.394  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:29.304  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:29.441  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:29.566  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:51.636  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:51.770  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:54.087  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:54.283  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:55.713  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:55.944  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:57.137  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:57.413  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:58.588  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:52:58.888  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:52:59.011  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:53:01.656  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:53:01.794  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:53:01.917  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:53:07.908  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:53:08.086  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:53:10.256  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:53:10.540  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:53:10.669  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:54:43.200  INFO 17712 --- [Thread-35] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:54:43.201  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 01:54:46.215  WARN 17712 --- [Thread-35] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 01:54:46.222  INFO 17712 --- [Thread-35] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:54:46.224  INFO 17712 --- [Thread-35] com.zaxxer.hikari.HikariDataSource       : HikariPool-5 - Shutdown initiated...
2020-12-16 01:54:46.257  INFO 17712 --- [Thread-35] com.zaxxer.hikari.HikariDataSource       : HikariPool-5 - Shutdown completed.
2020-12-16 01:54:47.512  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 01:54:49.539  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 01:54:49.540  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 01:54:49.542  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 01:54:49.846  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 01:54:49.906  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 59ms. Found 9 JPA repository interfaces.
2020-12-16 01:54:50.125  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 01:54:50.136  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 01:54:50.390  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 01:54:50.391  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 01:54:50.393  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 01:54:50.489  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 01:54:50.490  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 925 ms
2020-12-16 01:54:50.673  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 01:54:50.701  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-6 - Starting...
2020-12-16 01:54:50.750  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-6 - Start completed.
2020-12-16 01:54:50.765  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 01:54:51.939  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 01:54:51.940  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:54:51.959  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 01:54:52.059  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 01:54:52.619  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 01:54:52.640  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:54:52.659  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 01:54:52.671  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 01:54:52.672  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 01:54:53.338  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 01:54:53.656  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 7.267 seconds (JVM running for 876.771)
2020-12-16 01:54:53.659  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 01:54:54.405  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 01:54:54.407  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 01:54:54.415  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 7 ms
2020-12-16 01:54:54.562  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 01:54:54.574  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 01:54:58.779  INFO 17712 --- [Thread-43] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:54:58.780  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 01:55:01.781  WARN 17712 --- [Thread-43] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 01:55:01.783  INFO 17712 --- [Thread-43] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:55:01.785  INFO 17712 --- [Thread-43] com.zaxxer.hikari.HikariDataSource       : HikariPool-6 - Shutdown initiated...
2020-12-16 01:55:01.796  INFO 17712 --- [Thread-43] com.zaxxer.hikari.HikariDataSource       : HikariPool-6 - Shutdown completed.
2020-12-16 01:55:02.632  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 01:55:04.640  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 01:55:04.641  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 01:55:04.643  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 01:55:05.093  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 01:55:05.158  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 63ms. Found 9 JPA repository interfaces.
2020-12-16 01:55:05.365  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 01:55:05.401  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 01:55:05.612  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 01:55:05.613  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 01:55:05.613  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 01:55:05.652  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 01:55:05.653  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 976 ms
2020-12-16 01:55:05.712  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 01:55:05.719  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-7 - Starting...
2020-12-16 01:55:05.768  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-7 - Start completed.
2020-12-16 01:55:05.769  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 01:55:06.333  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 01:55:06.334  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:55:06.347  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 01:55:06.412  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 01:55:06.847  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 01:55:06.857  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:55:06.867  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 01:55:06.869  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 01:55:06.869  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 01:55:07.516  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 01:55:07.883  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 5.964 seconds (JVM running for 890.999)
2020-12-16 01:55:07.886  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 01:55:08.567  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 01:55:08.568  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 01:55:08.572  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 3 ms
2020-12-16 01:55:08.706  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 01:55:08.711  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 01:55:43.205 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 01:55:58.784 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 01:56:49.649  INFO 17712 --- [Thread-51] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:56:49.650  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 01:56:52.652  WARN 17712 --- [Thread-51] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 01:56:52.655  INFO 17712 --- [Thread-51] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:56:52.670  INFO 17712 --- [Thread-51] com.zaxxer.hikari.HikariDataSource       : HikariPool-7 - Shutdown initiated...
2020-12-16 01:56:52.683  INFO 17712 --- [Thread-51] com.zaxxer.hikari.HikariDataSource       : HikariPool-7 - Shutdown completed.
2020-12-16 01:56:53.748  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 01:56:55.762  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 01:56:55.763  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 01:56:55.764  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 01:56:56.306  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 01:56:56.381  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 74ms. Found 9 JPA repository interfaces.
2020-12-16 01:56:56.518  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 01:56:56.531  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 01:56:56.801  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 01:56:56.802  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 01:56:56.803  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 01:56:56.896  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 01:56:56.896  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1105 ms
2020-12-16 01:56:56.990  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 01:56:57.001  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-8 - Starting...
2020-12-16 01:56:57.030  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-8 - Start completed.
2020-12-16 01:56:57.031  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 01:56:58.395  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 01:56:58.395  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:56:58.409  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 01:56:58.503  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 01:56:58.954  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 01:56:58.955  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:56:58.966  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 01:56:58.973  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 01:56:58.974  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 01:56:59.527  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 01:56:59.885  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 7.062 seconds (JVM running for 1003.001)
2020-12-16 01:56:59.888  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 01:57:00.679  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 01:57:00.680  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 01:57:00.685  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 5 ms
2020-12-16 01:57:00.832  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 01:57:00.838  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 01:57:03.275  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:57:03.599  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:03.747  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:06.012  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:57:06.161  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:09.792  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:57:10.250  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:12.568  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:57:12.870  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:14.907  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:57:15.191  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:16.887  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:57:17.157  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:17.288  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:19.163  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:57:19.307  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:19.462  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:26.018  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:57:26.157  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:26.281  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:29.726  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:57:29.871  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:31.858  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:57:32.159  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:32.294  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:42.464  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:57:42.625  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:45.199  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:57:45.339  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:45.463  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:57:49.655 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 01:58:07.579  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:58:07.719  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:58:10.678  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:58:10.811  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:58:53.775  INFO 17712 --- [Thread-59] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:58:53.777  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 01:58:56.777  WARN 17712 --- [Thread-59] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 01:58:56.780  INFO 17712 --- [Thread-59] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:58:56.808  INFO 17712 --- [Thread-59] com.zaxxer.hikari.HikariDataSource       : HikariPool-8 - Shutdown initiated...
2020-12-16 01:58:56.819  INFO 17712 --- [Thread-59] com.zaxxer.hikari.HikariDataSource       : HikariPool-8 - Shutdown completed.
2020-12-16 01:58:57.859  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 01:58:59.867  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 01:58:59.867  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 01:58:59.869  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 01:59:00.184  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 01:59:00.245  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 60ms. Found 9 JPA repository interfaces.
2020-12-16 01:59:00.417  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 01:59:00.441  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 01:59:00.620  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 01:59:00.621  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 01:59:00.621  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 01:59:00.666  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 01:59:00.667  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 786 ms
2020-12-16 01:59:00.749  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 01:59:00.757  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-9 - Starting...
2020-12-16 01:59:00.805  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-9 - Start completed.
2020-12-16 01:59:00.809  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 01:59:01.479  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 01:59:01.491  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 01:59:01.506  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 01:59:01.617  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 01:59:01.993  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 01:59:01.994  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 01:59:02.003  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 01:59:02.004  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 01:59:02.005  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 01:59:02.531  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 01:59:02.834  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 5.873 seconds (JVM running for 1125.95)
2020-12-16 01:59:02.837  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 01:59:03.710  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 01:59:03.712  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 01:59:03.758  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 9 ms
2020-12-16 01:59:03.930  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 01:59:03.943  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 01:59:06.775  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:07.063  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:11.464  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:11.610  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:17.685  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:17.835  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:17.973  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:20.852  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:21.006  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:24.515  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:24.662  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:28.418  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:28.673  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:33.965  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:34.208  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:36.720  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:36.942  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:40.576  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:40.871  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:41.006  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:43.221  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:43.369  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:46.250  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:46.495  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:48.986  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:49.287  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:51.821  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:52.084  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:53.782 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 01:59:54.375  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:54.602  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:54.736  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 01:59:57.364  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 01:59:57.511  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:00.512  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:00:00.842  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:02.670  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:00:02.878  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:04.319  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:00:04.558  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:06.000  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:00:06.242  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:06.381  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:08.014  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:00:08.165  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:08.301  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:11.609  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:00:11.773  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:13.993  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:00:14.224  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:14.360  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:17.953  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:00:18.098  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:21.044  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:00:21.195  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:21.340  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:24.372  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:00:24.518  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:00:54.638  INFO 17712 --- [Thread-67] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:00:54.639  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 02:00:57.641  WARN 17712 --- [Thread-67] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 02:00:57.645  INFO 17712 --- [Thread-67] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:00:57.689  INFO 17712 --- [Thread-67] com.zaxxer.hikari.HikariDataSource       : HikariPool-9 - Shutdown initiated...
2020-12-16 02:00:57.726  INFO 17712 --- [Thread-67] com.zaxxer.hikari.HikariDataSource       : HikariPool-9 - Shutdown completed.
2020-12-16 02:00:59.039  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 02:01:01.050  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 02:01:01.053  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 02:01:01.055  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 02:01:01.460  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 02:01:01.533  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 73ms. Found 9 JPA repository interfaces.
2020-12-16 02:01:01.658  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 02:01:01.672  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 02:01:01.813  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 02:01:01.814  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 02:01:01.815  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 02:01:01.900  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 02:01:02.016  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 953 ms
2020-12-16 02:01:02.176  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 02:01:02.190  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-10 - Starting...
2020-12-16 02:01:02.222  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-10 - Start completed.
2020-12-16 02:01:02.223  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 02:01:02.890  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 02:01:02.892  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:01:02.904  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 02:01:02.976  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 02:01:03.342  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 02:01:03.343  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:01:03.351  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 02:01:03.356  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 02:01:03.357  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 02:01:03.845  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 02:01:04.294  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 6.364 seconds (JVM running for 1247.409)
2020-12-16 02:01:04.301  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 02:01:05.028  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 02:01:05.037  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 02:01:05.042  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 5 ms
2020-12-16 02:01:05.182  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 02:01:05.191  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 02:01:16.016  INFO 17712 --- [Thread-75] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:01:16.017  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 02:01:19.017  WARN 17712 --- [Thread-75] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 02:01:19.019  INFO 17712 --- [Thread-75] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:01:19.032  INFO 17712 --- [Thread-75] com.zaxxer.hikari.HikariDataSource       : HikariPool-10 - Shutdown initiated...
2020-12-16 02:01:19.044  INFO 17712 --- [Thread-75] com.zaxxer.hikari.HikariDataSource       : HikariPool-10 - Shutdown completed.
2020-12-16 02:01:19.829  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 02:01:21.853  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 02:01:21.854  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 02:01:21.855  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 02:01:22.110  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 02:01:22.163  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 51ms. Found 9 JPA repository interfaces.
2020-12-16 02:01:22.243  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 02:01:22.253  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 02:01:22.371  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 02:01:22.372  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 02:01:22.373  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 02:01:22.412  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 02:01:22.412  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 551 ms
2020-12-16 02:01:22.483  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 02:01:22.490  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-11 - Starting...
2020-12-16 02:01:22.508  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-11 - Start completed.
2020-12-16 02:01:22.509  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 02:01:22.884  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 02:01:22.885  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:01:22.893  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 02:01:22.960  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 02:01:23.252  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 02:01:23.253  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:01:23.258  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 02:01:23.264  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 02:01:23.264  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 02:01:23.680  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 02:01:23.963  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 4.788 seconds (JVM running for 1267.078)
2020-12-16 02:01:23.966  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 02:01:24.673  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 02:01:24.674  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 02:01:24.679  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
2020-12-16 02:01:24.821  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 02:01:24.827  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 02:01:33.276  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:01:33.556  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:01:33.691  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:01:38.435  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:01:38.571  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:01:40.702  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:01:40.844  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:01:47.311  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:01:47.447  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:01:47.572  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:01:50.652  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:01:50.792  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:01:54.644 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 02:01:55.913  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:01:56.046  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:01:59.647  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:02:00.133  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:03.067  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:02:03.305  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:05.275  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:02:05.561  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:07.589  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:02:07.834  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:07.958  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:10.150  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:02:10.284  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:14.905  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:02:15.129  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:16.021 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 02:02:21.264  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:02:21.566  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:25.449  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:02:25.715  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:27.252  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:02:27.449  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:27.576  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:36.159  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:02:36.324  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:36.449  INFO 17712 --- [http-nio-5000-exec-8] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:39.348  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:02:39.482  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:39.620  INFO 17712 --- [http-nio-5000-exec-9] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:48.959  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:02:49.102  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:49.234  INFO 17712 --- [http-nio-5000-exec-10] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:54.267  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:02:54.408  INFO 17712 --- [http-nio-5000-exec-1] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:55.897  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:02:56.032  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:02:56.157  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:06:12.192  INFO 17712 --- [Thread-83] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:06:12.215  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 02:06:15.215  WARN 17712 --- [Thread-83] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 02:06:15.221  INFO 17712 --- [Thread-83] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:06:15.222  INFO 17712 --- [Thread-83] com.zaxxer.hikari.HikariDataSource       : HikariPool-11 - Shutdown initiated...
2020-12-16 02:06:15.241  INFO 17712 --- [Thread-83] com.zaxxer.hikari.HikariDataSource       : HikariPool-11 - Shutdown completed.
2020-12-16 02:06:16.415  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 02:06:18.424  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 02:06:18.424  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 02:06:18.426  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 02:06:18.777  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 02:06:18.844  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 66ms. Found 9 JPA repository interfaces.
2020-12-16 02:06:18.981  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 02:06:19.001  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 02:06:19.241  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 02:06:19.302  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 02:06:19.303  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 02:06:19.369  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 02:06:19.405  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 973 ms
2020-12-16 02:06:19.505  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 02:06:19.513  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-12 - Starting...
2020-12-16 02:06:19.567  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-12 - Start completed.
2020-12-16 02:06:19.579  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 02:06:20.201  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 02:06:20.206  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:06:20.220  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 02:06:20.348  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 02:06:20.762  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 02:06:20.762  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:06:20.770  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 02:06:20.771  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 02:06:20.773  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 02:06:21.478  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 02:06:21.984  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 6.593 seconds (JVM running for 1565.099)
2020-12-16 02:06:21.987  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 02:06:22.759  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 02:06:22.779  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 02:06:22.785  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 6 ms
2020-12-16 02:06:22.931  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 02:06:22.952  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 02:07:12.220 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 02:07:17.054  INFO 17712 --- [Thread-91] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:07:17.114  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 02:07:20.114  WARN 17712 --- [Thread-91] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 02:07:20.116  INFO 17712 --- [Thread-91] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:07:20.117  INFO 17712 --- [Thread-91] com.zaxxer.hikari.HikariDataSource       : HikariPool-12 - Shutdown initiated...
2020-12-16 02:07:20.131  INFO 17712 --- [Thread-91] com.zaxxer.hikari.HikariDataSource       : HikariPool-12 - Shutdown completed.
2020-12-16 02:07:21.393  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 02:07:23.402  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 02:07:23.433  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 02:07:23.437  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 02:07:23.797  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 02:07:23.868  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 56ms. Found 9 JPA repository interfaces.
2020-12-16 02:07:24.029  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 02:07:24.041  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 02:07:24.197  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 02:07:24.198  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 02:07:24.199  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 02:07:24.247  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 02:07:24.248  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 806 ms
2020-12-16 02:07:24.332  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 02:07:24.341  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-13 - Starting...
2020-12-16 02:07:24.357  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-13 - Start completed.
2020-12-16 02:07:24.358  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 02:07:24.722  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 02:07:24.723  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:07:24.730  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 02:07:24.783  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 02:07:25.166  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 02:07:25.171  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:07:25.177  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 02:07:25.179  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 02:07:25.179  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 02:07:25.736  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 02:07:26.096  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 5.824 seconds (JVM running for 1629.211)
2020-12-16 02:07:26.099  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 02:07:26.846  INFO 17712 --- [http-nio-5000-exec-2] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 02:07:27.039  INFO 17712 --- [http-nio-5000-exec-2] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 02:07:27.046  INFO 17712 --- [http-nio-5000-exec-2] o.s.web.servlet.DispatcherServlet        : Completed initialization in 6 ms
2020-12-16 02:07:27.187  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 02:07:27.194  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 02:08:17.122 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 02:08:25.738  INFO 17712 --- [Thread-99] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:08:25.739  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 02:08:28.741  WARN 17712 --- [Thread-99] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 02:08:28.745  INFO 17712 --- [Thread-99] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:08:28.746  INFO 17712 --- [Thread-99] com.zaxxer.hikari.HikariDataSource       : HikariPool-13 - Shutdown initiated...
2020-12-16 02:08:28.769  INFO 17712 --- [Thread-99] com.zaxxer.hikari.HikariDataSource       : HikariPool-13 - Shutdown completed.
2020-12-16 02:08:32.735  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 02:08:35.088  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 02:08:35.089  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 02:08:35.090  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 02:08:35.592  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 02:08:35.682  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 90ms. Found 9 JPA repository interfaces.
2020-12-16 02:08:35.935  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 02:08:35.949  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 02:08:36.147  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 02:08:36.149  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 02:08:36.150  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 02:08:36.225  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 02:08:36.226  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1129 ms
2020-12-16 02:08:36.356  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 02:08:36.368  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-14 - Starting...
2020-12-16 02:08:36.392  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-14 - Start completed.
2020-12-16 02:08:36.393  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 02:08:37.075  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 02:08:37.085  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:08:37.102  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 02:08:37.186  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 02:08:37.812  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 02:08:37.830  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:08:37.852  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 02:08:37.855  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 02:08:37.867  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 02:08:39.413  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 02:08:41.083  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 12.148 seconds (JVM running for 1704.198)
2020-12-16 02:08:41.110  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 02:08:41.979  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 02:08:41.980  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 02:08:41.987  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 7 ms
2020-12-16 02:08:42.160  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 02:08:42.188  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 02:09:25.743 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 02:14:14.044  INFO 17712 --- [Thread-107] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:14:14.046  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 02:14:17.047  WARN 17712 --- [Thread-107] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 02:14:17.050  INFO 17712 --- [Thread-107] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:14:17.052  INFO 17712 --- [Thread-107] com.zaxxer.hikari.HikariDataSource       : HikariPool-14 - Shutdown initiated...
2020-12-16 02:14:17.090  INFO 17712 --- [Thread-107] com.zaxxer.hikari.HikariDataSource       : HikariPool-14 - Shutdown completed.
2020-12-16 02:14:18.258  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 02:14:20.269  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 02:14:20.270  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 02:14:20.271  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 02:14:20.573  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 02:14:20.630  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 56ms. Found 9 JPA repository interfaces.
2020-12-16 02:14:20.737  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 02:14:20.749  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 02:14:20.869  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 02:14:20.870  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 02:14:20.871  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 02:14:20.914  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 02:14:20.914  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 639 ms
2020-12-16 02:14:21.040  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 02:14:21.055  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-15 - Starting...
2020-12-16 02:14:21.129  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-15 - Start completed.
2020-12-16 02:14:21.130  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 02:14:21.832  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 02:14:21.833  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:14:21.844  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 02:14:21.937  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 02:14:22.427  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 02:14:22.428  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:14:22.440  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 02:14:22.441  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 02:14:22.442  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 02:14:23.162  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 02:14:23.818  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 6.576 seconds (JVM running for 2046.933)
2020-12-16 02:14:23.820  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 02:14:24.650  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 02:14:24.654  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 02:14:24.660  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 5 ms
2020-12-16 02:14:24.805  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 02:14:24.825  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 02:15:14.052 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 02:18:59.510  INFO 17712 --- [Thread-115] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:18:59.547  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 02:19:02.549  WARN 17712 --- [Thread-115] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 02:19:02.552  INFO 17712 --- [Thread-115] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:19:02.555  INFO 17712 --- [Thread-115] com.zaxxer.hikari.HikariDataSource       : HikariPool-15 - Shutdown initiated...
2020-12-16 02:19:02.567  INFO 17712 --- [Thread-115] com.zaxxer.hikari.HikariDataSource       : HikariPool-15 - Shutdown completed.
2020-12-16 02:19:03.634  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 02:19:05.645  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 02:19:05.646  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 02:19:05.648  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 02:19:06.027  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 02:19:06.090  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 61ms. Found 9 JPA repository interfaces.
2020-12-16 02:19:06.179  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 02:19:06.190  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 02:19:06.503  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 02:19:06.505  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 02:19:06.505  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 02:19:06.544  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 02:19:06.545  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 890 ms
2020-12-16 02:19:06.618  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 02:19:06.627  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-16 - Starting...
2020-12-16 02:19:06.643  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-16 - Start completed.
2020-12-16 02:19:06.644  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 02:19:07.069  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 02:19:07.069  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:19:07.081  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 02:19:07.153  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 02:19:07.482  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 02:19:07.483  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:19:07.490  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 02:19:07.491  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 02:19:07.491  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 02:19:07.934  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 02:19:08.225  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 5.526 seconds (JVM running for 2331.34)
2020-12-16 02:19:08.228  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 02:19:08.975  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 02:19:08.977  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 02:19:08.983  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 5 ms
2020-12-16 02:19:09.118  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 02:19:09.125  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 02:19:59.599 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 02:20:49.421  INFO 17712 --- [Thread-123] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:20:49.422  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 02:20:52.424  WARN 17712 --- [Thread-123] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 02:20:52.427  INFO 17712 --- [Thread-123] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:20:52.428  INFO 17712 --- [Thread-123] com.zaxxer.hikari.HikariDataSource       : HikariPool-16 - Shutdown initiated...
2020-12-16 02:20:52.438  INFO 17712 --- [Thread-123] com.zaxxer.hikari.HikariDataSource       : HikariPool-16 - Shutdown completed.
2020-12-16 02:20:53.377  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 02:20:55.386  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 02:20:55.388  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 02:20:55.389  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 02:20:56.216  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 02:20:56.501  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 247ms. Found 9 JPA repository interfaces.
2020-12-16 02:20:56.818  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 02:20:56.846  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 02:20:57.167  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 02:20:57.174  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 02:20:57.180  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 02:20:57.267  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 02:20:57.276  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 1878 ms
2020-12-16 02:20:57.508  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 02:20:57.553  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-17 - Starting...
2020-12-16 02:20:57.603  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-17 - Start completed.
2020-12-16 02:20:57.604  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 02:20:59.304  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 02:20:59.351  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:20:59.365  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 02:20:59.482  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 02:21:00.393  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 02:21:00.394  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:21:00.414  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 02:21:00.415  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 02:21:00.415  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 02:21:01.032  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 02:21:01.650  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 9.05 seconds (JVM running for 2444.765)
2020-12-16 02:21:01.701  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 02:21:02.482  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 02:21:02.483  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 02:21:02.489  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 5 ms
2020-12-16 02:21:02.625  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 02:21:02.630  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 02:21:49.427 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 02:22:24.354  INFO 17712 --- [Thread-131] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:22:24.355  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 02:22:27.356  WARN 17712 --- [Thread-131] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 02:22:27.360  INFO 17712 --- [Thread-131] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:22:27.361  INFO 17712 --- [Thread-131] com.zaxxer.hikari.HikariDataSource       : HikariPool-17 - Shutdown initiated...
2020-12-16 02:22:27.375  INFO 17712 --- [Thread-131] com.zaxxer.hikari.HikariDataSource       : HikariPool-17 - Shutdown completed.
2020-12-16 02:22:28.663  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 02:22:30.681  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 02:22:30.691  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 02:22:30.694  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 02:22:31.170  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 02:22:31.241  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 69ms. Found 9 JPA repository interfaces.
2020-12-16 02:22:31.374  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 02:22:31.385  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 02:22:31.533  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 02:22:31.534  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 02:22:31.535  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 02:22:31.586  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 02:22:31.586  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 883 ms
2020-12-16 02:22:31.689  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 02:22:31.699  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-18 - Starting...
2020-12-16 02:22:31.720  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-18 - Start completed.
2020-12-16 02:22:31.721  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 02:22:32.195  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 02:22:32.195  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:22:32.205  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 02:22:32.271  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 02:22:32.593  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 02:22:32.594  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:22:32.601  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 02:22:32.602  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 02:22:32.602  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 02:22:33.155  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 02:22:33.663  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 6.121 seconds (JVM running for 2536.778)
2020-12-16 02:22:33.678  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 02:22:34.466  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 02:22:34.475  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 02:22:34.479  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
2020-12-16 02:22:34.647  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 02:22:34.654  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 02:23:24.360 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 02:23:45.893  INFO 17712 --- [Thread-139] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:23:45.894  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 02:23:48.895  WARN 17712 --- [Thread-139] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 02:23:48.898  INFO 17712 --- [Thread-139] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:23:48.899  INFO 17712 --- [Thread-139] com.zaxxer.hikari.HikariDataSource       : HikariPool-18 - Shutdown initiated...
2020-12-16 02:23:48.911  INFO 17712 --- [Thread-139] com.zaxxer.hikari.HikariDataSource       : HikariPool-18 - Shutdown completed.
2020-12-16 02:23:49.764  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 02:23:51.774  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 02:23:51.775  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 02:23:51.780  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 02:23:52.200  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 02:23:52.277  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 77ms. Found 9 JPA repository interfaces.
2020-12-16 02:23:52.373  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 02:23:52.381  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 02:23:52.504  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 02:23:52.505  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 02:23:52.506  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 02:23:52.543  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 02:23:52.543  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 756 ms
2020-12-16 02:23:52.606  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 02:23:52.613  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-19 - Starting...
2020-12-16 02:23:52.628  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-19 - Start completed.
2020-12-16 02:23:52.629  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 02:23:53.006  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 02:23:53.006  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:23:53.015  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 02:23:53.062  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 02:23:53.381  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 02:23:53.382  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:23:53.388  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 02:23:53.389  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 02:23:53.390  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 02:23:53.898  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 02:23:54.343  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 5.303 seconds (JVM running for 2617.459)
2020-12-16 02:23:54.347  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 02:23:55.050  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 02:23:55.052  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 02:23:55.057  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 5 ms
2020-12-16 02:23:55.197  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 02:23:55.205  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 02:24:14.055  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:24:14.219  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:24:15.770  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:24:15.902  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:24:17.637  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:24:17.777  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:24:17.903  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:24:21.332  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:24:21.472  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:24:23.121  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:24:23.254  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:24:23.378  INFO 17712 --- [http-nio-5000-exec-6] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:24:31.133  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:24:31.277  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:24:31.408  INFO 17712 --- [http-nio-5000-exec-7] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:24:45.897 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 02:25:00.147  INFO 17712 --- [Thread-147] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:25:00.152  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 02:25:03.154  WARN 17712 --- [Thread-147] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 02:25:03.157  INFO 17712 --- [Thread-147] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:25:03.169  INFO 17712 --- [Thread-147] com.zaxxer.hikari.HikariDataSource       : HikariPool-19 - Shutdown initiated...
2020-12-16 02:25:03.181  INFO 17712 --- [Thread-147] com.zaxxer.hikari.HikariDataSource       : HikariPool-19 - Shutdown completed.
2020-12-16 02:25:04.274  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://localhost:8888
2020-12-16 02:25:06.281  INFO 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://localhost:8888. Will be trying the next url if available
2020-12-16 02:25:06.282  WARN 17712 --- [restartedMain] c.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://localhost:8888/application/default": Connection refused: connect; nested exception is java.net.ConnectException: Connection refused: connect
2020-12-16 02:25:06.283  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : No active profile set, falling back to default profiles: default
2020-12-16 02:25:06.549  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2020-12-16 02:25:06.596  INFO 17712 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 47ms. Found 9 JPA repository interfaces.
2020-12-16 02:25:06.673  INFO 17712 --- [restartedMain] o.s.cloud.context.scope.GenericScope     : BeanFactory id=4364c041-4530-3f37-b030-d2baa5ef1efb
2020-12-16 02:25:06.683  INFO 17712 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'by.testbot.proxy.ViberProxy' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2020-12-16 02:25:06.797  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 5000 (http)
2020-12-16 02:25:06.798  INFO 17712 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2020-12-16 02:25:06.798  INFO 17712 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.39]
2020-12-16 02:25:06.842  INFO 17712 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2020-12-16 02:25:06.843  INFO 17712 --- [restartedMain] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 546 ms
2020-12-16 02:25:06.917  INFO 17712 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2020-12-16 02:25:06.924  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-20 - Starting...
2020-12-16 02:25:06.944  INFO 17712 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-20 - Start completed.
2020-12-16 02:25:06.953  INFO 17712 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2020-12-16 02:25:07.323  INFO 17712 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2020-12-16 02:25:07.324  INFO 17712 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:25:07.333  INFO 17712 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2020-12-16 02:25:07.400  WARN 17712 --- [restartedMain] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2020-12-16 02:25:07.662  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService
2020-12-16 02:25:07.663  INFO 17712 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:25:07.670  WARN 17712 --- [restartedMain] o.s.c.n.a.ArchaiusAutoConfiguration      : No spring.application.name found, defaulting to 'application'
2020-12-16 02:25:07.676  WARN 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : No URLs will be polled as dynamic configuration sources.
2020-12-16 02:25:07.677  INFO 17712 --- [restartedMain] c.n.c.sources.URLConfigurationSource     : To enable URLs as dynamic configuration sources, define System property archaius.configurationSource.additionalUrls or make config.properties available on classpath.
2020-12-16 02:25:08.100  INFO 17712 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 5000 (http) with context path ''
2020-12-16 02:25:08.384  INFO 17712 --- [restartedMain] by.testbot.TestbotApplication            : Started TestbotApplication in 5.054 seconds (JVM running for 2691.5)
2020-12-16 02:25:08.387  INFO 17712 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
2020-12-16 02:25:09.206  INFO 17712 --- [http-nio-5000-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2020-12-16 02:25:09.208  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2020-12-16 02:25:09.228  INFO 17712 --- [http-nio-5000-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 6 ms
2020-12-16 02:25:09.382  INFO 17712 --- [restartedMain] by.testbot.services.viber.ViberService   : Webhook setted with response: ok, events: [SUBSCRIBED, UNSUBSCRIBED, CONVERSATION_STARTED, FAILED, MESSAGE]
2020-12-16 02:25:09.387  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service started
2020-12-16 02:25:11.724  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:25:11.884  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:25:12.018  INFO 17712 --- [http-nio-5000-exec-2] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:25:17.909  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:25:18.068  INFO 17712 --- [http-nio-5000-exec-3] by.testbot.services.viber.ViberService   : Text message sended to user: gbcD9ezHUeQkbrYUwyU3Bw==
2020-12-16 02:25:19.983  INFO 17712 --- [http-nio-5000-exec-4] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:25:20.005 ERROR 17712 --- [http-nio-5000-exec-4] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.dao.DataIntegrityViolationException: not-null property references a null or transient value : by.testbot.models.BotMessage.message; nested exception is org.hibernate.PropertyValueException: not-null property references a null or transient value : by.testbot.models.BotMessage.message] with root cause

org.hibernate.PropertyValueException: not-null property references a null or transient value : by.testbot.models.BotMessage.message
	at org.hibernate.engine.internal.Nullability.checkNullability(Nullability.java:111) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.engine.internal.Nullability.checkNullability(Nullability.java:55) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.DefaultFlushEntityEventListener.scheduleUpdate(DefaultFlushEntityEventListener.java:315) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.DefaultFlushEntityEventListener.onFlushEntity(DefaultFlushEntityEventListener.java:170) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.flushEntities(AbstractFlushingEventListener.java:232) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:92) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:102) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1362) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:453) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:3212) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2380) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:447) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:183) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.access$300(JdbcResourceLocalTransactionCoordinatorImpl.java:40) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:281) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:534) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:633) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:386) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.BotMessageService$$EnhancerBySpringCGLIB$$8966ce7a.save(<generated>) ~[classes/:na]
	at by.testbot.bot.BotState$14.handleInput(BotState.java:647) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleTextMessage(ViberService.java:641) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleMessageCallback(ViberService.java:434) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleUpdate(ViberService.java:425) ~[classes/:na]
	at by.testbot.services.viber.WebhookService.onWebhookUpdateReceived(WebhookService.java:69) ~[classes/:na]
	at by.testbot.controllers.WebhookController.onUpdateReceived(WebhookController.java:19) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652) ~[tomcat-embed-core-9.0.39.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733) ~[tomcat-embed-core-9.0.39.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]

2020-12-16 02:25:20.350  INFO 17712 --- [http-nio-5000-exec-5] by.testbot.services.viber.ViberService   : Received MessageCallback from user: gbcD9ezHUeQkbrYUwyU3Bw==, message type: TEXT
2020-12-16 02:25:20.362 ERROR 17712 --- [http-nio-5000-exec-5] o.a.c.c.C.[.[.[/].[dispatcherServlet]    : Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception [Request processing failed; nested exception is org.springframework.dao.DataIntegrityViolationException: not-null property references a null or transient value : by.testbot.models.BotMessage.message; nested exception is org.hibernate.PropertyValueException: not-null property references a null or transient value : by.testbot.models.BotMessage.message] with root cause

org.hibernate.PropertyValueException: not-null property references a null or transient value : by.testbot.models.BotMessage.message
	at org.hibernate.engine.internal.Nullability.checkNullability(Nullability.java:111) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.engine.internal.Nullability.checkNullability(Nullability.java:55) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.DefaultFlushEntityEventListener.scheduleUpdate(DefaultFlushEntityEventListener.java:315) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.DefaultFlushEntityEventListener.onFlushEntity(DefaultFlushEntityEventListener.java:170) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.flushEntities(AbstractFlushingEventListener.java:232) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.AbstractFlushingEventListener.flushEverythingToExecutions(AbstractFlushingEventListener.java:92) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:39) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:102) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionImpl.doFlush(SessionImpl.java:1362) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:453) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:3212) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2380) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:447) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:183) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.access$300(JdbcResourceLocalTransactionCoordinatorImpl.java:40) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:281) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:101) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:534) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:743) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:711) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:633) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:386) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.BotMessageService$$EnhancerBySpringCGLIB$$8966ce7a.save(<generated>) ~[classes/:na]
	at by.testbot.bot.BotState$14.handleInput(BotState.java:647) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleTextMessage(ViberService.java:641) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleMessageCallback(ViberService.java:434) ~[classes/:na]
	at by.testbot.services.viber.ViberService.handleUpdate(ViberService.java:425) ~[classes/:na]
	at by.testbot.services.viber.WebhookService.onWebhookUpdateReceived(WebhookService.java:69) ~[classes/:na]
	at by.testbot.controllers.WebhookController.onUpdateReceived(WebhookController.java:19) ~[classes/:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:na]
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]
	at java.base/java.lang.reflect.Method.invoke(Method.java:566) ~[na:na]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652) ~[tomcat-embed-core-9.0.39.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) ~[spring-webmvc-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733) ~[tomcat-embed-core-9.0.39.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) ~[tomcat-embed-websocket-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) ~[spring-web-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:868) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1590) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) ~[tomcat-embed-core-9.0.39.jar:9.0.39]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]

2020-12-16 02:26:00.184 ERROR 17712 --- [threadPoolTaskExecutor-1] .a.i.SimpleAsyncUncaughtExceptionHandler : Unexpected exception occurred invoking async method: public void by.testbot.services.async.BroadcastServiceAsync.runAsync()

org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction; nested exception is java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:448) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:400) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:373) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:574) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:361) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118) ~[spring-tx-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:691) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at by.testbot.services.PostponeMessageService$$EnhancerBySpringCGLIB$$ad470c47.getAllWithoutLast(<generated>) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.idleMessagesAsync(BroadcastServiceAsync.java:57) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync.runAsync(BroadcastServiceAsync.java:49) ~[classes/:na]
	at by.testbot.services.async.BroadcastServiceAsync$$FastClassBySpringCGLIB$$1ab3ef16.invoke(<generated>) ~[classes/:na]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218) ~[spring-core-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:771) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:749) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.aop.interceptor.AsyncExecutionInterceptor.lambda$invoke$0(AsyncExecutionInterceptor.java:115) ~[spring-aop-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[na:na]
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[na:na]
	at java.base/java.lang.Thread.run(Thread.java:834) ~[na:na]
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:509) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:588) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:156) ~[hibernate-core-5.4.22.Final.jar:5.4.22.Final]
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:466) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:391) ~[spring-orm-5.2.10.RELEASE.jar:5.2.10.RELEASE]
	... 21 common frames omitted

2020-12-16 02:26:05.499  INFO 17712 --- [Thread-155] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'threadPoolTaskExecutor'
2020-12-16 02:26:05.507  INFO 17712 --- [threadPoolTaskExecutor-1] b.t.s.async.BroadcastServiceAsync        : Postpone message service stopped: sleep interrupted
2020-12-16 02:26:08.507  WARN 17712 --- [Thread-155] o.s.s.concurrent.ThreadPoolTaskExecutor  : Timed out while waiting for executor 'threadPoolTaskExecutor' to terminate
2020-12-16 02:26:08.509  INFO 17712 --- [Thread-155] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
2020-12-16 02:26:08.523  INFO 17712 --- [Thread-155] com.zaxxer.hikari.HikariDataSource       : HikariPool-20 - Shutdown initiated...
2020-12-16 02:26:08.540  INFO 17712 --- [Thread-155] com.zaxxer.hikari.HikariDataSource       : HikariPool-20 - Shutdown completed.
